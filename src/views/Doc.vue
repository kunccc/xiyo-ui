<template>
  <TopNav toggleAsideButtonVisible underlineVisible/>
  <div class="mask" :class="{asideVisible}" @click="toggleAside" ref="mask"/>
  <div class="content">
    <Aside/>
    <main @click="toggleAside" :class="{asideVisible}">
      <router-view/>
    </main>
  </div>
</template>

<script lang="ts">
import TopNav from '../components/TopNav.vue';
import Aside from '../components/Aside.vue';
import {inject, onMounted, Ref, ref} from 'vue';

export default {
  components: {TopNav, Aside},
  setup() {
    const asideVisible = inject<Ref<boolean>>('asideVisible');
    const toggleAside = () => {
      asideVisible.value = false;
    };
    const mask = ref<HTMLDivElement>(null);
    onMounted(() => {
      mask.value.addEventListener('wheel', e => {
        if (asideVisible.value) e.preventDefault();
      });
    });
    return {toggleAside, asideVisible, mask};
  }
};
</script>

<style lang="scss" scoped>
.content {
  main {
    padding: 86px 30px 36px 230px;
    transition: all .3s;
  }
}
@media (max-width: 500px) {
  .content {
    main {
      padding-left: 28px;
      transform: translateX(0);
      &.asideVisible {
        transform: translateX(200px);
      }
    }
  }
  .mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.28);
    opacity: 0;
    z-index: -1;
    &.asideVisible {
      opacity: 1;
      z-index: 8;
    }
  }
}
</style>